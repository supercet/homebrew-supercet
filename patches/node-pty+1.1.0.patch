diff --git a/node_modules/node-pty/lib/unixTerminal.js b/node_modules/node-pty/lib/unixTerminal.js
index 1ec12f7..6ddeaf5 100644
--- a/node_modules/node-pty/lib/unixTerminal.js
+++ b/node_modules/node-pty/lib/unixTerminal.js
@@ -30,6 +30,23 @@ var helperPath = native.dir + '/spawn-helper';
 helperPath = path.resolve(__dirname, helperPath);
 helperPath = helperPath.replace('app.asar', 'app.asar.unpacked');
 helperPath = helperPath.replace('node_modules.asar', 'node_modules.asar.unpacked');
+// In pkg/yao-pkg, files under /snapshot are not executable. Copy the helper
+// to a real temp file and mark it executable.
+if (process.pkg) {
+    try {
+        var os = require("os");
+        var crypto = require("crypto");
+        var tmp = path.join(
+            os.tmpdir(),
+            "node-pty-spawn-helper-" + process.platform + "-" + process.arch + "-" + crypto.randomBytes(6).toString("hex")
+        );
+        fs.copyFileSync(helperPath, tmp);
+        fs.chmodSync(tmp, 0o755);
+        helperPath = tmp;
+    } catch (e) {
+        console.error("Failed to materialize spawn-helper:", e);
+    }
+}
 var DEFAULT_FILE = 'sh';
 var DEFAULT_NAME = 'xterm';
 var DESTROY_SOCKET_TIMEOUT_MS = 200;
diff --git a/node_modules/node-pty/lib/utils.js b/node_modules/node-pty/lib/utils.js
index af7918b..6879bf8 100644
--- a/node_modules/node-pty/lib/utils.js
+++ b/node_modules/node-pty/lib/utils.js
@@ -15,6 +15,34 @@ function assign(target) {
 }
 exports.assign = assign;
 function loadNativeModule(name) {
+    // Handle pkg/yao-pkg bundled executables
+    if (process.pkg) {
+        var path = require('path');
+        var fs = require('fs');
+        var os = require('os');
+        var crypto = require('crypto');
+
+        // Try to find the native module in the snapshot
+        var moduleName = name + '.node';
+        var possiblePaths = [
+            path.join(__dirname, '..', 'build', 'Release', moduleName),
+            path.join(__dirname, '..', 'prebuilds', process.platform + '-' + process.arch, moduleName)
+        ];
+
+        for (var i = 0; i < possiblePaths.length; i++) {
+            try {
+                var tmpPath = path.join(os.tmpdir(), 'node-pty-' + moduleName + '-' + crypto.randomBytes(6).toString('hex'));
+                fs.copyFileSync(possiblePaths[i], tmpPath);
+                var module = require(tmpPath);
+                var dir = path.dirname(possiblePaths[i]);
+                return { dir: dir, module: module };
+            } catch (e) {
+                // Continue to next path
+            }
+        }
+        // Fall through to normal loading if pkg-specific loading fails
+    }
+
     // Check build, debug, and then prebuilds.
     var dirs = ['build/Release', 'build/Debug', "prebuilds/" + process.platform + "-" + process.arch];
     // Check relative to the parent dir for unbundled and then the current dir for bundled
